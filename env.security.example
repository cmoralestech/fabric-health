# =============================================================================
# SECURITY CONFIGURATION TEMPLATE FOR MEDICAL APPLICATION
# =============================================================================
# Copy this to .env and .env.local with your actual values
# NEVER commit actual secrets to version control

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
DATABASE_URL="mongodb+srv://username:password@cluster.mongodb.net/surgery-management?retryWrites=true&w=majority"

# =============================================================================
# AUTHENTICATION & SESSION SECURITY
# =============================================================================
# NextAuth configuration
NEXTAUTH_URL="http://localhost:3000"
NEXTAUTH_SECRET="your-super-secure-secret-key-at-least-32-characters-long"

# Session security
SESSION_TIMEOUT_MINUTES=30
MAX_CONCURRENT_SESSIONS=2
SESSION_RENEWAL_WINDOW_MINUTES=5

# =============================================================================
# ENCRYPTION FOR PHI DATA (HIPAA REQUIREMENT)
# =============================================================================
# AES-256-GCM encryption key for PHI data
# CRITICAL: Generate a secure 32-character key for production
PHI_ENCRYPTION_KEY="your-32-character-encryption-key-here"

# Key rotation schedule (days)
ENCRYPTION_KEY_ROTATION_DAYS=90

# =============================================================================
# AUDIT LOGGING CONFIGURATION
# =============================================================================
# Audit log retention (years) - HIPAA requires minimum 6 years
AUDIT_RETENTION_YEARS=6

# External audit log service (for production)
# AUDIT_LOG_ENDPOINT="https://your-siem-service.com/api/logs"
# AUDIT_LOG_API_KEY="your-audit-service-api-key"

# =============================================================================
# RATE LIMITING CONFIGURATION
# =============================================================================
# Login attempts - INCREASED FOR ASSESSMENT/DEMO PURPOSES
# Production should use 5 attempts per 15 minutes for security
LOGIN_RATE_LIMIT_ATTEMPTS=20
LOGIN_RATE_LIMIT_WINDOW_MINUTES=15

# API rate limits (requests per minute)
API_READ_RATE_LIMIT=100
API_WRITE_RATE_LIMIT=20
API_SEARCH_RATE_LIMIT=50

# Export limits (exports per hour)
EXPORT_RATE_LIMIT=5

# =============================================================================
# SECURITY HEADERS & CSP
# =============================================================================
# Content Security Policy
CSP_SCRIPT_SRC="'self' 'unsafe-inline' 'unsafe-eval'"
CSP_STYLE_SRC="'self' 'unsafe-inline'"
CSP_IMG_SRC="'self' data:"
CSP_FONT_SRC="'self'"

# HSTS settings
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true

# =============================================================================
# DATA LOSS PREVENTION (DLP)
# =============================================================================
# Maximum records per export
MAX_EXPORT_RECORDS=1000

# Export approval required for bulk exports
EXPORT_APPROVAL_REQUIRED=true

# Export watermarking
EXPORT_WATERMARKING_ENABLED=true

# Export expiry time (hours)
EXPORT_EXPIRY_HOURS=24

# =============================================================================
# MONITORING & ALERTING
# =============================================================================
# Unusual access monitoring
MONITOR_UNUSUAL_ACCESS=true
MONITOR_BULK_DOWNLOADS=true
MONITOR_OFF_HOURS_ACCESS=true

# Alert thresholds
FAILED_LOGIN_ALERT_THRESHOLD=10
BULK_EXPORT_ALERT_THRESHOLD=5
SUSPICIOUS_ACTIVITY_ALERT_THRESHOLD=20

# Notification endpoints
# SECURITY_ALERT_WEBHOOK="https://your-monitoring-service.com/webhook"
# SECURITY_ALERT_EMAIL="security@yourorganization.com"

# =============================================================================
# ENVIRONMENT CONFIGURATION
# =============================================================================
NODE_ENV="development"

# Security level (affects data masking and logging verbosity)
SECURITY_LEVEL="high" # low, medium, high

# Enable/disable security features for development
DEV_DISABLE_RATE_LIMITING=false
DEV_DISABLE_ENCRYPTION=false
DEV_MOCK_AUDIT_LOGGING=false

# =============================================================================
# BACKUP & DISASTER RECOVERY
# =============================================================================
# Backup encryption
BACKUP_ENCRYPTION_ENABLED=true
BACKUP_RETENTION_DAYS=2555 # 7 years for HIPAA compliance

# Disaster recovery
DR_SITE_URL="https://your-dr-site.com"
DR_SYNC_INTERVAL_HOURS=4

# =============================================================================
# COMPLIANCE SETTINGS
# =============================================================================
# HIPAA compliance mode
HIPAA_COMPLIANCE_MODE=true

# Minimum password requirements
PASSWORD_MIN_LENGTH=12
PASSWORD_REQUIRE_COMPLEXITY=true
PASSWORD_HISTORY_COUNT=12
PASSWORD_MAX_AGE_DAYS=90

# Account lockout policy
ACCOUNT_LOCKOUT_THRESHOLD=5
ACCOUNT_LOCKOUT_DURATION_MINUTES=30

# =============================================================================
# DEVELOPMENT & TESTING
# =============================================================================
# Development-only settings (DO NOT USE IN PRODUCTION)
DEV_SHOW_DETAILED_ERRORS=false
DEV_ALLOW_HTTP=false
DEV_SKIP_SSL_VERIFICATION=false

# Test data configuration
SEED_TEST_DATA=true
TEST_USER_PASSWORD="SecureTestPassword123!"

# =============================================================================
# NOTES FOR PRODUCTION DEPLOYMENT
# =============================================================================
# 1. Generate strong, unique values for all secrets
# 2. Use a proper key management service (AWS KMS, Azure Key Vault, etc.)
# 3. Enable external audit logging to a SIEM system
# 4. Configure proper SSL/TLS certificates
# 5. Set up monitoring and alerting for security events
# 6. Implement proper backup and disaster recovery procedures
# 7. Conduct regular security audits and penetration testing
# 8. Ensure compliance with HIPAA, SOC 2, and other relevant standards
